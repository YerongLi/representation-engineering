Train:   0%|                                                                           | 0/1107 [00:00<?, ?it/s]/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
Train:   9%|█████▊                                                           | 100/1107 [03:58<40:22,  2.41s/it]
{'loss': 2.69973183, 'acc': 0.47710815, 'grad_norm': 3.78417444, 'learning_rate': 0.0, 'memory(GiB)': 19.7, 'train_speed(iter/s)': 0.213497, 'epoch': 0.0, 'global_step/max_steps': '1/1107', 'percentage': '0.09%', 'elapsed_time': '2s', 'remaining_time': '49m 44s'}
{'loss': 3.32385572, 'acc': 0.38989658, 'grad_norm': 6.51825094, 'learning_rate': 6.53e-05, 'memory(GiB)': 19.7, 'train_speed(iter/s)': 0.395206, 'epoch': 0.01, 'global_step/max_steps': '10/1107', 'percentage': '0.90%', 'elapsed_time': '23s', 'remaining_time': '42m 37s'}
{'loss': 2.2738596, 'acc': 0.52817473, 'grad_norm': 3.98561311, 'learning_rate': 8.495e-05, 'memory(GiB)': 23.63, 'train_speed(iter/s)': 0.406646, 'epoch': 0.02, 'global_step/max_steps': '20/1107', 'percentage': '1.81%', 'elapsed_time': '47s', 'remaining_time': '42m 45s'}
{'loss': 1.34008713, 'acc': 0.67924213, 'grad_norm': 3.61695051, 'learning_rate': 9.645e-05, 'memory(GiB)': 23.63, 'train_speed(iter/s)': 0.410077, 'epoch': 0.03, 'global_step/max_steps': '30/1107', 'percentage': '2.71%', 'elapsed_time': '1m 11s', 'remaining_time': '42m 35s'}
{'loss': 1.45682306, 'acc': 0.6734899, 'grad_norm': 3.02989197, 'learning_rate': 9.999e-05, 'memory(GiB)': 23.63, 'train_speed(iter/s)': 0.413107, 'epoch': 0.04, 'global_step/max_steps': '40/1107', 'percentage': '3.61%', 'elapsed_time': '1m 34s', 'remaining_time': '42m 9s'}
{'loss': 1.33534317, 'acc': 0.66391077, 'grad_norm': 3.13290524, 'learning_rate': 9.995e-05, 'memory(GiB)': 23.63, 'train_speed(iter/s)': 0.41514, 'epoch': 0.05, 'global_step/max_steps': '50/1107', 'percentage': '4.52%', 'elapsed_time': '1m 58s', 'remaining_time': '41m 44s'}
{'loss': 1.38417454, 'acc': 0.67904348, 'grad_norm': 2.83833861, 'learning_rate': 9.986e-05, 'memory(GiB)': 23.63, 'train_speed(iter/s)': 0.415805, 'epoch': 0.05, 'global_step/max_steps': '60/1107', 'percentage': '5.42%', 'elapsed_time': '2m 22s', 'remaining_time': '41m 23s'}
{'loss': 1.39428759, 'acc': 0.68683925, 'grad_norm': 3.79841661, 'learning_rate': 9.972e-05, 'memory(GiB)': 23.63, 'train_speed(iter/s)': 0.415782, 'epoch': 0.06, 'global_step/max_steps': '70/1107', 'percentage': '6.32%', 'elapsed_time': '2m 46s', 'remaining_time': '41m 4s'}
{'loss': 1.28264637, 'acc': 0.68502584, 'grad_norm': 3.52087903, 'learning_rate': 9.955e-05, 'memory(GiB)': 23.63, 'train_speed(iter/s)': 0.416156, 'epoch': 0.07, 'global_step/max_steps': '80/1107', 'percentage': '7.23%', 'elapsed_time': '3m 10s', 'remaining_time': '40m 42s'}
{'loss': 1.35037994, 'acc': 0.68277631, 'grad_norm': 3.60187197, 'learning_rate': 9.933e-05, 'memory(GiB)': 23.63, 'train_speed(iter/s)': 0.415977, 'epoch': 0.08, 'global_step/max_steps': '90/1107', 'percentage': '8.13%', 'elapsed_time': '3m 34s', 'remaining_time': '40m 22s'}
{'loss': 1.3023428, 'acc': 0.69798026, 'grad_norm': 2.23040485, 'learning_rate': 9.907e-05, 'memory(GiB)': 23.63, 'train_speed(iter/s)': 0.415524, 'epoch': 0.09, 'global_step/max_steps': '100/1107', 'percentage': '9.03%', 'elapsed_time': '3m 58s', 'remaining_time': '40m 3s'}
Val: 100%|████████████████████████████████████████████████████████████████████| 178/178 [00:07<00:00, 22.61it/s]
{'eval_loss': 1.29905355, 'eval_acc': 0.6961326, 'eval_runtime': 7.9562, 'eval_samples_per_second': 22.373, 'eval_steps_per_second': 22.373, 'epoch': 0.09, 'global_step/max_steps': '100/1107', 'percentage': '9.03%', 'elapsed_time': '4m 6s', 'remaining_time': '41m 23s'}
[INFO:swift] Saving model checkpoint to /home/yerong2/representation-engineering/lorra_finetune/qwfine/output/qwen2_5-7b/v4-20240924-151132/checkpoint-100
/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
Train:  18%|███████████▋                                                     | 200/1107 [08:13<36:13,  2.40s/it]
{'loss': 1.39787292, 'acc': 0.67469397, 'grad_norm': 2.64401388, 'learning_rate': 9.877e-05, 'memory(GiB)': 24.65, 'train_speed(iter/s)': 0.392671, 'epoch': 0.1, 'global_step/max_steps': '110/1107', 'percentage': '9.94%', 'elapsed_time': '4m 38s', 'remaining_time': '42m 1s'}
{'loss': 1.47694683, 'acc': 0.66534176, 'grad_norm': 3.26846886, 'learning_rate': 9.842e-05, 'memory(GiB)': 24.65, 'train_speed(iter/s)': 0.395171, 'epoch': 0.11, 'global_step/max_steps': '120/1107', 'percentage': '10.84%', 'elapsed_time': '5m 1s', 'remaining_time': '41m 21s'}
{'loss': 1.24078035, 'acc': 0.67605343, 'grad_norm': 2.87691903, 'learning_rate': 9.804e-05, 'memory(GiB)': 24.65, 'train_speed(iter/s)': 0.397134, 'epoch': 0.12, 'global_step/max_steps': '130/1107', 'percentage': '11.74%', 'elapsed_time': '5m 25s', 'remaining_time': '40m 45s'}
{'loss': 1.3830162, 'acc': 0.69074287, 'grad_norm': 3.29043126, 'learning_rate': 9.761e-05, 'memory(GiB)': 25.84, 'train_speed(iter/s)': 0.398205, 'epoch': 0.13, 'global_step/max_steps': '140/1107', 'percentage': '12.65%', 'elapsed_time': '5m 49s', 'remaining_time': '40m 14s'}
{'loss': 1.34597092, 'acc': 0.67608547, 'grad_norm': 2.96257925, 'learning_rate': 9.714e-05, 'memory(GiB)': 25.84, 'train_speed(iter/s)': 0.399562, 'epoch': 0.14, 'global_step/max_steps': '150/1107', 'percentage': '13.55%', 'elapsed_time': '6m 13s', 'remaining_time': '39m 42s'}
{'loss': 1.19243555, 'acc': 0.71060371, 'grad_norm': 2.53429222, 'learning_rate': 9.664e-05, 'memory(GiB)': 25.84, 'train_speed(iter/s)': 0.399762, 'epoch': 0.14, 'global_step/max_steps': '160/1107', 'percentage': '14.45%', 'elapsed_time': '6m 38s', 'remaining_time': '39m 17s'}
{'loss': 1.26944923, 'acc': 0.69136772, 'grad_norm': 2.48299599, 'learning_rate': 9.609e-05, 'memory(GiB)': 25.84, 'train_speed(iter/s)': 0.400546, 'epoch': 0.15, 'global_step/max_steps': '170/1107', 'percentage': '15.36%', 'elapsed_time': '7m 2s', 'remaining_time': '38m 48s'}
{'loss': 1.30375986, 'acc': 0.68301344, 'grad_norm': 3.08292651, 'learning_rate': 9.55e-05, 'memory(GiB)': 25.84, 'train_speed(iter/s)': 0.401126, 'epoch': 0.16, 'global_step/max_steps': '180/1107', 'percentage': '16.26%', 'elapsed_time': '7m 26s', 'remaining_time': '38m 20s'}
{'loss': 1.35358791, 'acc': 0.69693079, 'grad_norm': 3.86905813, 'learning_rate': 9.488e-05, 'memory(GiB)': 25.84, 'train_speed(iter/s)': 0.402458, 'epoch': 0.17, 'global_step/max_steps': '190/1107', 'percentage': '17.16%', 'elapsed_time': '7m 50s', 'remaining_time': '37m 48s'}
{'loss': 1.19354124, 'acc': 0.7062808, 'grad_norm': 3.95020008, 'learning_rate': 9.421e-05, 'memory(GiB)': 25.84, 'train_speed(iter/s)': 0.403629, 'epoch': 0.18, 'global_step/max_steps': '200/1107', 'percentage': '18.07%', 'elapsed_time': '8m 13s', 'remaining_time': '37m 18s'}
Val: 100%|████████████████████████████████████████████████████████████████████| 178/178 [00:07<00:00, 22.60it/s]
{'eval_loss': 1.25115097, 'eval_acc': 0.69928966, 'eval_runtime': 7.9714, 'eval_samples_per_second': 22.33, 'eval_steps_per_second': 22.33, 'epoch': 0.18, 'global_step/max_steps': '200/1107', 'percentage': '18.07%', 'elapsed_time': '8m 21s', 'remaining_time': '37m 54s'}
[INFO:swift] Saving model checkpoint to /home/yerong2/representation-engineering/lorra_finetune/qwfine/output/qwen2_5-7b/v4-20240924-151132/checkpoint-200
/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
Train:  27%|█████████████████▌                                               | 300/1107 [12:26<31:11,  2.32s/it]
{'loss': 1.27184706, 'acc': 0.70072355, 'grad_norm': 4.73477888, 'learning_rate': 9.351e-05, 'memory(GiB)': 25.84, 'train_speed(iter/s)': 0.393337, 'epoch': 0.19, 'global_step/max_steps': '210/1107', 'percentage': '18.97%', 'elapsed_time': '8m 51s', 'remaining_time': '37m 52s'}
{'loss': 1.25310783, 'acc': 0.70405917, 'grad_norm': 3.1518929, 'learning_rate': 9.277e-05, 'memory(GiB)': 25.84, 'train_speed(iter/s)': 0.394244, 'epoch': 0.2, 'global_step/max_steps': '220/1107', 'percentage': '19.87%', 'elapsed_time': '9m 16s', 'remaining_time': '37m 21s'}
{'loss': 1.35910807, 'acc': 0.68978209, 'grad_norm': 2.76944828, 'learning_rate': 9.199e-05, 'memory(GiB)': 25.84, 'train_speed(iter/s)': 0.39479, 'epoch': 0.21, 'global_step/max_steps': '230/1107', 'percentage': '20.78%', 'elapsed_time': '9m 40s', 'remaining_time': '36m 53s'}
{'loss': 1.25818119, 'acc': 0.69744439, 'grad_norm': 4.00462055, 'learning_rate': 9.118e-05, 'memory(GiB)': 25.84, 'train_speed(iter/s)': 0.395867, 'epoch': 0.22, 'global_step/max_steps': '240/1107', 'percentage': '21.68%', 'elapsed_time': '10m 4s', 'remaining_time': '36m 22s'}
{'loss': 1.28596134, 'acc': 0.69429364, 'grad_norm': 3.32074356, 'learning_rate': 9.033e-05, 'memory(GiB)': 25.84, 'train_speed(iter/s)': 0.396571, 'epoch': 0.23, 'global_step/max_steps': '250/1107', 'percentage': '22.58%', 'elapsed_time': '10m 28s', 'remaining_time': '35m 54s'}
{'loss': 1.24451313, 'acc': 0.69359412, 'grad_norm': 3.10003114, 'learning_rate': 8.945e-05, 'memory(GiB)': 25.84, 'train_speed(iter/s)': 0.397743, 'epoch': 0.23, 'global_step/max_steps': '260/1107', 'percentage': '23.49%', 'elapsed_time': '10m 51s', 'remaining_time': '35m 23s'}
{'loss': 1.32798996, 'acc': 0.69124656, 'grad_norm': 3.24090338, 'learning_rate': 8.853e-05, 'memory(GiB)': 25.84, 'train_speed(iter/s)': 0.398569, 'epoch': 0.24, 'global_step/max_steps': '270/1107', 'percentage': '24.39%', 'elapsed_time': '11m 15s', 'remaining_time': '34m 53s'}
{'loss': 1.14960651, 'acc': 0.70834684, 'grad_norm': 2.06873655, 'learning_rate': 8.758e-05, 'memory(GiB)': 27.35, 'train_speed(iter/s)': 0.399247, 'epoch': 0.25, 'global_step/max_steps': '280/1107', 'percentage': '25.29%', 'elapsed_time': '11m 39s', 'remaining_time': '34m 25s'}
{'loss': 1.24381924, 'acc': 0.68798022, 'grad_norm': 2.87932873, 'learning_rate': 8.66e-05, 'memory(GiB)': 27.35, 'train_speed(iter/s)': 0.399955, 'epoch': 0.26, 'global_step/max_steps': '290/1107', 'percentage': '26.20%', 'elapsed_time': '12m 3s', 'remaining_time': '33m 57s'}
{'loss': 1.28618765, 'acc': 0.69642591, 'grad_norm': 3.17343926, 'learning_rate': 8.559e-05, 'memory(GiB)': 27.35, 'train_speed(iter/s)': 0.400761, 'epoch': 0.27, 'global_step/max_steps': '300/1107', 'percentage': '27.10%', 'elapsed_time': '12m 26s', 'remaining_time': '33m 28s'}
Val: 100%|████████████████████████████████████████████████████████████████████| 178/178 [00:07<00:00, 22.70it/s]
{'eval_loss': 1.22036326, 'eval_acc': 0.71191792, 'eval_runtime': 7.9248, 'eval_samples_per_second': 22.461, 'eval_steps_per_second': 22.461, 'epoch': 0.27, 'global_step/max_steps': '300/1107', 'percentage': '27.10%', 'elapsed_time': '12m 34s', 'remaining_time': '33m 49s'}
[INFO:swift] Saving model checkpoint to /home/yerong2/representation-engineering/lorra_finetune/qwfine/output/qwen2_5-7b/v4-20240924-151132/checkpoint-300
/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
Train:  36%|███████████████████████▍                                         | 400/1107 [16:40<28:04,  2.38s/it]
{'loss': 1.17453804, 'acc': 0.71135125, 'grad_norm': 3.52974868, 'learning_rate': 8.455e-05, 'memory(GiB)': 27.35, 'train_speed(iter/s)': 0.393768, 'epoch': 0.28, 'global_step/max_steps': '310/1107', 'percentage': '28.00%', 'elapsed_time': '13m 5s', 'remaining_time': '33m 38s'}
{'loss': 1.26329851, 'acc': 0.70179372, 'grad_norm': 3.21407557, 'learning_rate': 8.347e-05, 'memory(GiB)': 27.35, 'train_speed(iter/s)': 0.394669, 'epoch': 0.29, 'global_step/max_steps': '320/1107', 'percentage': '28.91%', 'elapsed_time': '13m 28s', 'remaining_time': '33m 9s'}
{'loss': 1.34634275, 'acc': 0.67991223, 'grad_norm': 3.70637941, 'learning_rate': 8.237e-05, 'memory(GiB)': 27.35, 'train_speed(iter/s)': 0.395433, 'epoch': 0.3, 'global_step/max_steps': '330/1107', 'percentage': '29.81%', 'elapsed_time': '13m 52s', 'remaining_time': '32m 40s'}
{'loss': 1.3504756, 'acc': 0.67120361, 'grad_norm': 3.10389256, 'learning_rate': 8.124e-05, 'memory(GiB)': 27.35, 'train_speed(iter/s)': 0.39602, 'epoch': 0.31, 'global_step/max_steps': '340/1107', 'percentage': '30.71%', 'elapsed_time': '14m 16s', 'remaining_time': '32m 12s'}
{'loss': 1.33020668, 'acc': 0.6979466, 'grad_norm': 2.87087226, 'learning_rate': 8.009e-05, 'memory(GiB)': 27.35, 'train_speed(iter/s)': 0.396484, 'epoch': 0.32, 'global_step/max_steps': '350/1107', 'percentage': '31.62%', 'elapsed_time': '14m 40s', 'remaining_time': '31m 44s'}
{'loss': 1.21312962, 'acc': 0.7072638, 'grad_norm': 3.20903301, 'learning_rate': 7.89e-05, 'memory(GiB)': 27.35, 'train_speed(iter/s)': 0.397239, 'epoch': 0.33, 'global_step/max_steps': '360/1107', 'percentage': '32.52%', 'elapsed_time': '15m 4s', 'remaining_time': '31m 16s'}
{'loss': 1.30823717, 'acc': 0.69052629, 'grad_norm': 3.49778819, 'learning_rate': 7.77e-05, 'memory(GiB)': 27.35, 'train_speed(iter/s)': 0.3975, 'epoch': 0.33, 'global_step/max_steps': '370/1107', 'percentage': '33.42%', 'elapsed_time': '15m 28s', 'remaining_time': '30m 50s'}
{'loss': 1.27639141, 'acc': 0.70461268, 'grad_norm': 3.71618891, 'learning_rate': 7.647e-05, 'memory(GiB)': 27.35, 'train_speed(iter/s)': 0.398125, 'epoch': 0.34, 'global_step/max_steps': '380/1107', 'percentage': '34.33%', 'elapsed_time': '15m 52s', 'remaining_time': '30m 22s'}
{'loss': 1.28524704, 'acc': 0.7084024, 'grad_norm': 3.50820613, 'learning_rate': 7.521e-05, 'memory(GiB)': 27.35, 'train_speed(iter/s)': 0.39863, 'epoch': 0.35, 'global_step/max_steps': '390/1107', 'percentage': '35.23%', 'elapsed_time': '16m 16s', 'remaining_time': '29m 55s'}
{'loss': 1.18595638, 'acc': 0.71944628, 'grad_norm': 2.74712563, 'learning_rate': 7.394e-05, 'memory(GiB)': 27.35, 'train_speed(iter/s)': 0.399103, 'epoch': 0.36, 'global_step/max_steps': '400/1107', 'percentage': '36.13%', 'elapsed_time': '16m 40s', 'remaining_time': '29m 27s'}
Val: 100%|████████████████████████████████████████████████████████████████████| 178/178 [00:07<00:00, 22.67it/s]
{'eval_loss': 1.20672703, 'eval_acc': 0.71270718, 'eval_runtime': 7.9542, 'eval_samples_per_second': 22.378, 'eval_steps_per_second': 22.378, 'epoch': 0.36, 'global_step/max_steps': '400/1107', 'percentage': '36.13%', 'elapsed_time': '16m 48s', 'remaining_time': '29m 42s'}
[INFO:swift] Saving model checkpoint to /home/yerong2/representation-engineering/lorra_finetune/qwfine/output/qwen2_5-7b/v4-20240924-151132/checkpoint-400
/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
Train:  45%|█████████████████████████████▎                                   | 500/1107 [20:53<23:43,  2.35s/it]
{'loss': 1.21694088, 'acc': 0.71219959, 'grad_norm': 3.49979663, 'learning_rate': 7.264e-05, 'memory(GiB)': 27.35, 'train_speed(iter/s)': 0.393751, 'epoch': 0.37, 'global_step/max_steps': '410/1107', 'percentage': '37.04%', 'elapsed_time': '17m 19s', 'remaining_time': '29m 26s'}
{'loss': 1.34279299, 'acc': 0.70315809, 'grad_norm': 2.62658906, 'learning_rate': 7.133e-05, 'memory(GiB)': 27.35, 'train_speed(iter/s)': 0.394427, 'epoch': 0.38, 'global_step/max_steps': '420/1107', 'percentage': '37.94%', 'elapsed_time': '17m 42s', 'remaining_time': '28m 58s'}
{'loss': 1.12335968, 'acc': 0.7067543, 'grad_norm': 3.19030809, 'learning_rate': 7e-05, 'memory(GiB)': 27.35, 'train_speed(iter/s)': 0.394907, 'epoch': 0.39, 'global_step/max_steps': '430/1107', 'percentage': '38.84%', 'elapsed_time': '18m 6s', 'remaining_time': '28m 31s'}
{'loss': 1.08863478, 'acc': 0.73097901, 'grad_norm': 2.44112206, 'learning_rate': 6.865e-05, 'memory(GiB)': 27.35, 'train_speed(iter/s)': 0.395533, 'epoch': 0.4, 'global_step/max_steps': '440/1107', 'percentage': '39.75%', 'elapsed_time': '18m 30s', 'remaining_time': '28m 3s'}
{'loss': 1.28684788, 'acc': 0.68151603, 'grad_norm': 2.53419352, 'learning_rate': 6.728e-05, 'memory(GiB)': 27.35, 'train_speed(iter/s)': 0.395801, 'epoch': 0.41, 'global_step/max_steps': '450/1107', 'percentage': '40.65%', 'elapsed_time': '18m 54s', 'remaining_time': '27m 37s'}
{'loss': 1.21434393, 'acc': 0.70754519, 'grad_norm': 3.01934481, 'learning_rate': 6.59e-05, 'memory(GiB)': 27.35, 'train_speed(iter/s)': 0.396224, 'epoch': 0.42, 'global_step/max_steps': '460/1107', 'percentage': '41.55%', 'elapsed_time': '19m 18s', 'remaining_time': '27m 10s'}
{'loss': 1.212286, 'acc': 0.70784564, 'grad_norm': 3.12287521, 'learning_rate': 6.45e-05, 'memory(GiB)': 27.35, 'train_speed(iter/s)': 0.396596, 'epoch': 0.42, 'global_step/max_steps': '470/1107', 'percentage': '42.46%', 'elapsed_time': '19m 43s', 'remaining_time': '26m 43s'}
{'loss': 1.28550587, 'acc': 0.68810692, 'grad_norm': 3.27084374, 'learning_rate': 6.31e-05, 'memory(GiB)': 27.35, 'train_speed(iter/s)': 0.397113, 'epoch': 0.43, 'global_step/max_steps': '480/1107', 'percentage': '43.36%', 'elapsed_time': '20m 6s', 'remaining_time': '26m 16s'}
{'loss': 1.13516026, 'acc': 0.71694489, 'grad_norm': 2.70462227, 'learning_rate': 6.168e-05, 'memory(GiB)': 27.35, 'train_speed(iter/s)': 0.397594, 'epoch': 0.44, 'global_step/max_steps': '490/1107', 'percentage': '44.26%', 'elapsed_time': '20m 30s', 'remaining_time': '25m 49s'}
{'loss': 1.10346622, 'acc': 0.73293433, 'grad_norm': 4.19468641, 'learning_rate': 6.025e-05, 'memory(GiB)': 27.35, 'train_speed(iter/s)': 0.398147, 'epoch': 0.45, 'global_step/max_steps': '500/1107', 'percentage': '45.17%', 'elapsed_time': '20m 53s', 'remaining_time': '25m 22s'}
Val: 100%|████████████████████████████████████████████████████████████████████| 178/178 [00:07<00:00, 22.65it/s]
{'eval_loss': 1.20251679, 'eval_acc': 0.71033938, 'eval_runtime': 7.9591, 'eval_samples_per_second': 22.364, 'eval_steps_per_second': 22.364, 'epoch': 0.45, 'global_step/max_steps': '500/1107', 'percentage': '45.17%', 'elapsed_time': '21m 1s', 'remaining_time': '25m 31s'}
[INFO:swift] Saving model checkpoint to /home/yerong2/representation-engineering/lorra_finetune/qwfine/output/qwen2_5-7b/v4-20240924-151132/checkpoint-500
/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
Train:  54%|███████████████████████████████████▏                             | 600/1107 [25:01<20:24,  2.42s/it]
{'loss': 1.20089884, 'acc': 0.70586662, 'grad_norm': 3.92152309, 'learning_rate': 5.881e-05, 'memory(GiB)': 27.35, 'train_speed(iter/s)': 0.394112, 'epoch': 0.46, 'global_step/max_steps': '510/1107', 'percentage': '46.07%', 'elapsed_time': '21m 32s', 'remaining_time': '25m 12s'}
{'loss': 1.26357975, 'acc': 0.6919198, 'grad_norm': 3.12173653, 'learning_rate': 5.737e-05, 'memory(GiB)': 27.35, 'train_speed(iter/s)': 0.394762, 'epoch': 0.47, 'global_step/max_steps': '520/1107', 'percentage': '46.97%', 'elapsed_time': '21m 55s', 'remaining_time': '24m 44s'}
{'loss': 1.11813555, 'acc': 0.70262213, 'grad_norm': 3.50030851, 'learning_rate': 5.592e-05, 'memory(GiB)': 27.35, 'train_speed(iter/s)': 0.3954, 'epoch': 0.48, 'global_step/max_steps': '530/1107', 'percentage': '47.88%', 'elapsed_time': '22m 18s', 'remaining_time': '24m 17s'}
{'loss': 1.2532526, 'acc': 0.69104333, 'grad_norm': 3.68905854, 'learning_rate': 5.446e-05, 'memory(GiB)': 27.35, 'train_speed(iter/s)': 0.39577, 'epoch': 0.49, 'global_step/max_steps': '540/1107', 'percentage': '48.78%', 'elapsed_time': '22m 42s', 'remaining_time': '23m 50s'}
{'loss': 1.13541174, 'acc': 0.72836847, 'grad_norm': 3.02019763, 'learning_rate': 5.3e-05, 'memory(GiB)': 27.35, 'train_speed(iter/s)': 0.3964, 'epoch': 0.5, 'global_step/max_steps': '550/1107', 'percentage': '49.68%', 'elapsed_time': '23m 5s', 'remaining_time': '23m 23s'}
{'loss': 1.18635187, 'acc': 0.70467958, 'grad_norm': 3.65846682, 'learning_rate': 5.154e-05, 'memory(GiB)': 27.35, 'train_speed(iter/s)': 0.397019, 'epoch': 0.51, 'global_step/max_steps': '560/1107', 'percentage': '50.59%', 'elapsed_time': '23m 28s', 'remaining_time': '22m 55s'}
{'loss': 1.31715622, 'acc': 0.69361677, 'grad_norm': 2.80231667, 'learning_rate': 5.008e-05, 'memory(GiB)': 27.35, 'train_speed(iter/s)': 0.397519, 'epoch': 0.51, 'global_step/max_steps': '570/1107', 'percentage': '51.49%', 'elapsed_time': '23m 51s', 'remaining_time': '22m 29s'}
{'loss': 1.17839031, 'acc': 0.71257114, 'grad_norm': 2.8242712, 'learning_rate': 4.861e-05, 'memory(GiB)': 27.35, 'train_speed(iter/s)': 0.398055, 'epoch': 0.52, 'global_step/max_steps': '580/1107', 'percentage': '52.39%', 'elapsed_time': '24m 15s', 'remaining_time': '22m 2s'}
{'loss': 1.14828463, 'acc': 0.72722883, 'grad_norm': 4.8586669, 'learning_rate': 4.715e-05, 'memory(GiB)': 27.35, 'train_speed(iter/s)': 0.398584, 'epoch': 0.53, 'global_step/max_steps': '590/1107', 'percentage': '53.30%', 'elapsed_time': '24m 38s', 'remaining_time': '21m 35s'}
{'loss': 1.3025404, 'acc': 0.68956842, 'grad_norm': 5.37635517, 'learning_rate': 4.569e-05, 'memory(GiB)': 27.35, 'train_speed(iter/s)': 0.398958, 'epoch': 0.54, 'global_step/max_steps': '600/1107', 'percentage': '54.20%', 'elapsed_time': '25m 1s', 'remaining_time': '21m 9s'}
Val: 100%|████████████████████████████████████████████████████████████████████| 178/178 [00:07<00:00, 22.75it/s]
{'eval_loss': 1.18846214, 'eval_acc': 0.71270718, 'eval_runtime': 7.9099, 'eval_samples_per_second': 22.504, 'eval_steps_per_second': 22.504, 'epoch': 0.54, 'global_step/max_steps': '600/1107', 'percentage': '54.20%', 'elapsed_time': '25m 9s', 'remaining_time': '21m 15s'}
[INFO:swift] Saving model checkpoint to /home/yerong2/representation-engineering/lorra_finetune/qwfine/output/qwen2_5-7b/v4-20240924-151132/checkpoint-600
/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
Train:  63%|█████████████████████████████████████████                        | 700/1107 [29:13<15:49,  2.33s/it]
{'loss': 1.26272087, 'acc': 0.68700771, 'grad_norm': 2.45895362, 'learning_rate': 4.424e-05, 'memory(GiB)': 27.35, 'train_speed(iter/s)': 0.395431, 'epoch': 0.55, 'global_step/max_steps': '610/1107', 'percentage': '55.10%', 'elapsed_time': '25m 40s', 'remaining_time': '20m 55s'}
{'loss': 1.13819351, 'acc': 0.72823057, 'grad_norm': 2.46233606, 'learning_rate': 4.278e-05, 'memory(GiB)': 27.35, 'train_speed(iter/s)': 0.395723, 'epoch': 0.56, 'global_step/max_steps': '620/1107', 'percentage': '56.01%', 'elapsed_time': '26m 4s', 'remaining_time': '20m 29s'}
{'loss': 1.1860405, 'acc': 0.71998715, 'grad_norm': 2.78738904, 'learning_rate': 4.134e-05, 'memory(GiB)': 27.35, 'train_speed(iter/s)': 0.396305, 'epoch': 0.57, 'global_step/max_steps': '630/1107', 'percentage': '56.91%', 'elapsed_time': '26m 27s', 'remaining_time': '20m 2s'}
{'loss': 1.17475739, 'acc': 0.70968924, 'grad_norm': 2.42364502, 'learning_rate': 3.99e-05, 'memory(GiB)': 27.35, 'train_speed(iter/s)': 0.396694, 'epoch': 0.58, 'global_step/max_steps': '640/1107', 'percentage': '57.81%', 'elapsed_time': '26m 51s', 'remaining_time': '19m 35s'}
{'loss': 1.21106806, 'acc': 0.69844332, 'grad_norm': 2.97329021, 'learning_rate': 3.847e-05, 'memory(GiB)': 27.35, 'train_speed(iter/s)': 0.397059, 'epoch': 0.59, 'global_step/max_steps': '650/1107', 'percentage': '58.72%', 'elapsed_time': '27m 15s', 'remaining_time': '19m 9s'}
{'loss': 1.17876339, 'acc': 0.70753255, 'grad_norm': 3.14930177, 'learning_rate': 3.705e-05, 'memory(GiB)': 27.35, 'train_speed(iter/s)': 0.397484, 'epoch': 0.6, 'global_step/max_steps': '660/1107', 'percentage': '59.62%', 'elapsed_time': '27m 38s', 'remaining_time': '18m 43s'}
{'loss': 1.25431776, 'acc': 0.71933098, 'grad_norm': 3.99156189, 'learning_rate': 3.565e-05, 'memory(GiB)': 28.93, 'train_speed(iter/s)': 0.397659, 'epoch': 0.6, 'global_step/max_steps': '670/1107', 'percentage': '60.52%', 'elapsed_time': '28m 2s', 'remaining_time': '18m 17s'}
{'loss': 1.28438845, 'acc': 0.68979635, 'grad_norm': 4.07730818, 'learning_rate': 3.425e-05, 'memory(GiB)': 28.93, 'train_speed(iter/s)': 0.398032, 'epoch': 0.61, 'global_step/max_steps': '680/1107', 'percentage': '61.43%', 'elapsed_time': '28m 26s', 'remaining_time': '17m 51s'}
{'loss': 1.17247648, 'acc': 0.71492167, 'grad_norm': 2.69220328, 'learning_rate': 3.287e-05, 'memory(GiB)': 28.93, 'train_speed(iter/s)': 0.398402, 'epoch': 0.62, 'global_step/max_steps': '690/1107', 'percentage': '62.33%', 'elapsed_time': '28m 49s', 'remaining_time': '17m 25s'}
{'loss': 1.20679693, 'acc': 0.69301763, 'grad_norm': 2.85396171, 'learning_rate': 3.15e-05, 'memory(GiB)': 28.93, 'train_speed(iter/s)': 0.398813, 'epoch': 0.63, 'global_step/max_steps': '700/1107', 'percentage': '63.23%', 'elapsed_time': '29m 13s', 'remaining_time': '16m 59s'}
Val: 100%|████████████████████████████████████████████████████████████████████| 178/178 [00:07<00:00, 22.66it/s]
{'eval_loss': 1.17299676, 'eval_acc': 0.71586425, 'eval_runtime': 7.9563, 'eval_samples_per_second': 22.372, 'eval_steps_per_second': 22.372, 'epoch': 0.63, 'global_step/max_steps': '700/1107', 'percentage': '63.23%', 'elapsed_time': '29m 21s', 'remaining_time': '17m 3s'}
[INFO:swift] Saving model checkpoint to /home/yerong2/representation-engineering/lorra_finetune/qwfine/output/qwen2_5-7b/v4-20240924-151132/checkpoint-700
/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
Train:  72%|██████████████████████████████████████████████▉                  | 800/1107 [33:22<11:56,  2.33s/it]
{'loss': 1.14999666, 'acc': 0.71047497, 'grad_norm': 3.04367828, 'learning_rate': 3.015e-05, 'memory(GiB)': 28.93, 'train_speed(iter/s)': 0.395843, 'epoch': 0.64, 'global_step/max_steps': '710/1107', 'percentage': '64.14%', 'elapsed_time': '29m 51s', 'remaining_time': '16m 41s'}
{'loss': 1.18201656, 'acc': 0.72614331, 'grad_norm': 4.241786, 'learning_rate': 2.881e-05, 'memory(GiB)': 28.93, 'train_speed(iter/s)': 0.396275, 'epoch': 0.65, 'global_step/max_steps': '720/1107', 'percentage': '65.04%', 'elapsed_time': '30m 14s', 'remaining_time': '16m 15s'}
{'loss': 1.23340082, 'acc': 0.70455041, 'grad_norm': 3.29614902, 'learning_rate': 2.75e-05, 'memory(GiB)': 28.93, 'train_speed(iter/s)': 0.396539, 'epoch': 0.66, 'global_step/max_steps': '730/1107', 'percentage': '65.94%', 'elapsed_time': '30m 38s', 'remaining_time': '15m 49s'}
{'loss': 1.24778662, 'acc': 0.67560096, 'grad_norm': 3.37558603, 'learning_rate': 2.62e-05, 'memory(GiB)': 28.93, 'train_speed(iter/s)': 0.397007, 'epoch': 0.67, 'global_step/max_steps': '740/1107', 'percentage': '66.85%', 'elapsed_time': '31m 1s', 'remaining_time': '15m 23s'}
{'loss': 1.24380007, 'acc': 0.68669634, 'grad_norm': 3.7353754, 'learning_rate': 2.492e-05, 'memory(GiB)': 28.93, 'train_speed(iter/s)': 0.397466, 'epoch': 0.68, 'global_step/max_steps': '750/1107', 'percentage': '67.75%', 'elapsed_time': '31m 24s', 'remaining_time': '14m 57s'}
{'loss': 1.17912035, 'acc': 0.71325092, 'grad_norm': 3.9644773, 'learning_rate': 2.367e-05, 'memory(GiB)': 28.93, 'train_speed(iter/s)': 0.397804, 'epoch': 0.69, 'global_step/max_steps': '760/1107', 'percentage': '68.65%', 'elapsed_time': '31m 48s', 'remaining_time': '14m 31s'}
{'loss': 1.28742161, 'acc': 0.68010569, 'grad_norm': 3.16169596, 'learning_rate': 2.243e-05, 'memory(GiB)': 28.93, 'train_speed(iter/s)': 0.398079, 'epoch': 0.7, 'global_step/max_steps': '770/1107', 'percentage': '69.56%', 'elapsed_time': '32m 12s', 'remaining_time': '14m 5s'}
{'loss': 1.2199851, 'acc': 0.6939877, 'grad_norm': 3.07450294, 'learning_rate': 2.123e-05, 'memory(GiB)': 28.93, 'train_speed(iter/s)': 0.39841, 'epoch': 0.7, 'global_step/max_steps': '780/1107', 'percentage': '70.46%', 'elapsed_time': '32m 35s', 'remaining_time': '13m 39s'}
{'loss': 1.16884947, 'acc': 0.71642141, 'grad_norm': 3.74557495, 'learning_rate': 2.004e-05, 'memory(GiB)': 28.93, 'train_speed(iter/s)': 0.398837, 'epoch': 0.71, 'global_step/max_steps': '790/1107', 'percentage': '71.36%', 'elapsed_time': '32m 58s', 'remaining_time': '13m 14s'}
{'loss': 1.1621356, 'acc': 0.7203301, 'grad_norm': 2.62721062, 'learning_rate': 1.888e-05, 'memory(GiB)': 28.93, 'train_speed(iter/s)': 0.399099, 'epoch': 0.72, 'global_step/max_steps': '800/1107', 'percentage': '72.27%', 'elapsed_time': '33m 22s', 'remaining_time': '12m 48s'}
Val: 100%|████████████████████████████████████████████████████████████████████| 178/178 [00:07<00:00, 22.51it/s]
{'eval_loss': 1.16784751, 'eval_acc': 0.72059984, 'eval_runtime': 8.0097, 'eval_samples_per_second': 22.223, 'eval_steps_per_second': 22.223, 'epoch': 0.72, 'global_step/max_steps': '800/1107', 'percentage': '72.27%', 'elapsed_time': '33m 30s', 'remaining_time': '12m 51s'}
[INFO:swift] Saving model checkpoint to /home/yerong2/representation-engineering/lorra_finetune/qwfine/output/qwen2_5-7b/v4-20240924-151132/checkpoint-800
/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
Train:  81%|████████████████████████████████████████████████████▊            | 900/1107 [37:32<08:15,  2.40s/it]
{'loss': 1.17987747, 'acc': 0.72021103, 'grad_norm': 3.12731147, 'learning_rate': 1.775e-05, 'memory(GiB)': 28.93, 'train_speed(iter/s)': 0.39638, 'epoch': 0.73, 'global_step/max_steps': '810/1107', 'percentage': '73.17%', 'elapsed_time': '34m 1s', 'remaining_time': '12m 28s'}
{'loss': 1.14995136, 'acc': 0.73226233, 'grad_norm': 3.275172, 'learning_rate': 1.665e-05, 'memory(GiB)': 28.93, 'train_speed(iter/s)': 0.396729, 'epoch': 0.74, 'global_step/max_steps': '820/1107', 'percentage': '74.07%', 'elapsed_time': '34m 24s', 'remaining_time': '12m 2s'}
{'loss': 1.25201626, 'acc': 0.69595509, 'grad_norm': 3.34442782, 'learning_rate': 1.557e-05, 'memory(GiB)': 28.93, 'train_speed(iter/s)': 0.397176, 'epoch': 0.75, 'global_step/max_steps': '830/1107', 'percentage': '74.98%', 'elapsed_time': '34m 47s', 'remaining_time': '11m 36s'}
{'loss': 1.32530546, 'acc': 0.6972311, 'grad_norm': 3.49479699, 'learning_rate': 1.452e-05, 'memory(GiB)': 28.93, 'train_speed(iter/s)': 0.397675, 'epoch': 0.76, 'global_step/max_steps': '840/1107', 'percentage': '75.88%', 'elapsed_time': '35m 10s', 'remaining_time': '11m 10s'}
{'loss': 1.23648357, 'acc': 0.6961647, 'grad_norm': 3.36357212, 'learning_rate': 1.351e-05, 'memory(GiB)': 28.93, 'train_speed(iter/s)': 0.398026, 'epoch': 0.77, 'global_step/max_steps': '850/1107', 'percentage': '76.78%', 'elapsed_time': '35m 33s', 'remaining_time': '10m 45s'}
{'loss': 1.17222986, 'acc': 0.69197016, 'grad_norm': 3.06938839, 'learning_rate': 1.252e-05, 'memory(GiB)': 28.93, 'train_speed(iter/s)': 0.398287, 'epoch': 0.78, 'global_step/max_steps': '860/1107', 'percentage': '77.69%', 'elapsed_time': '35m 57s', 'remaining_time': '10m 19s'}
{'loss': 1.15318632, 'acc': 0.71001215, 'grad_norm': 2.59980536, 'learning_rate': 1.157e-05, 'memory(GiB)': 28.93, 'train_speed(iter/s)': 0.398438, 'epoch': 0.79, 'global_step/max_steps': '870/1107', 'percentage': '78.59%', 'elapsed_time': '36m 21s', 'remaining_time': '9m 54s'}
{'loss': 1.18234015, 'acc': 0.72249446, 'grad_norm': 3.26602983, 'learning_rate': 1.065e-05, 'memory(GiB)': 28.93, 'train_speed(iter/s)': 0.398744, 'epoch': 0.79, 'global_step/max_steps': '880/1107', 'percentage': '79.49%', 'elapsed_time': '36m 44s', 'remaining_time': '9m 28s'}
{'loss': 1.22480669, 'acc': 0.7053587, 'grad_norm': 3.25923228, 'learning_rate': 9.77e-06, 'memory(GiB)': 28.93, 'train_speed(iter/s)': 0.398991, 'epoch': 0.8, 'global_step/max_steps': '890/1107', 'percentage': '80.40%', 'elapsed_time': '37m 8s', 'remaining_time': '9m 3s'}
{'loss': 1.14878588, 'acc': 0.70573864, 'grad_norm': 2.75963068, 'learning_rate': 8.91e-06, 'memory(GiB)': 28.93, 'train_speed(iter/s)': 0.39923, 'epoch': 0.81, 'global_step/max_steps': '900/1107', 'percentage': '81.30%', 'elapsed_time': '37m 32s', 'remaining_time': '8m 38s'}
Val: 100%|████████████████████████████████████████████████████████████████████| 178/178 [00:07<00:00, 22.68it/s]
{'eval_loss': 1.16120589, 'eval_acc': 0.72138911, 'eval_runtime': 7.9495, 'eval_samples_per_second': 22.391, 'eval_steps_per_second': 22.391, 'epoch': 0.81, 'global_step/max_steps': '900/1107', 'percentage': '81.30%', 'elapsed_time': '37m 40s', 'remaining_time': '8m 39s'}
[INFO:swift] Saving model checkpoint to /home/yerong2/representation-engineering/lorra_finetune/qwfine/output/qwen2_5-7b/v4-20240924-151132/checkpoint-900
/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
Train:  90%|█████████████████████████████████████████████████████████▊      | 1000/1107 [41:40<04:13,  2.37s/it]
{'loss': 1.19874678, 'acc': 0.69943881, 'grad_norm': 2.6418457, 'learning_rate': 8.1e-06, 'memory(GiB)': 28.93, 'train_speed(iter/s)': 0.397029, 'epoch': 0.82, 'global_step/max_steps': '910/1107', 'percentage': '82.20%', 'elapsed_time': '38m 10s', 'remaining_time': '8m 15s'}
{'loss': 1.21179504, 'acc': 0.71437707, 'grad_norm': 2.69945049, 'learning_rate': 7.32e-06, 'memory(GiB)': 28.93, 'train_speed(iter/s)': 0.39725, 'epoch': 0.83, 'global_step/max_steps': '920/1107', 'percentage': '83.11%', 'elapsed_time': '38m 33s', 'remaining_time': '7m 50s'}
{'loss': 1.23024626, 'acc': 0.7085104, 'grad_norm': 3.4521358, 'learning_rate': 6.57e-06, 'memory(GiB)': 28.93, 'train_speed(iter/s)': 0.397625, 'epoch': 0.84, 'global_step/max_steps': '930/1107', 'percentage': '84.01%', 'elapsed_time': '38m 56s', 'remaining_time': '7m 24s'}
{'loss': 1.19700298, 'acc': 0.70055933, 'grad_norm': 4.67988873, 'learning_rate': 5.87e-06, 'memory(GiB)': 28.93, 'train_speed(iter/s)': 0.397927, 'epoch': 0.85, 'global_step/max_steps': '940/1107', 'percentage': '84.91%', 'elapsed_time': '39m 20s', 'remaining_time': '6m 59s'}
{'loss': 1.26434822, 'acc': 0.69750185, 'grad_norm': 3.01142359, 'learning_rate': 5.2e-06, 'memory(GiB)': 28.93, 'train_speed(iter/s)': 0.39824, 'epoch': 0.86, 'global_step/max_steps': '950/1107', 'percentage': '85.82%', 'elapsed_time': '39m 43s', 'remaining_time': '6m 33s'}
{'loss': 1.14709101, 'acc': 0.73182325, 'grad_norm': 3.60255957, 'learning_rate': 4.57e-06, 'memory(GiB)': 28.93, 'train_speed(iter/s)': 0.398497, 'epoch': 0.87, 'global_step/max_steps': '960/1107', 'percentage': '86.72%', 'elapsed_time': '40m 7s', 'remaining_time': '6m 8s'}
{'loss': 1.21637936, 'acc': 0.70980291, 'grad_norm': 2.90430069, 'learning_rate': 3.98e-06, 'memory(GiB)': 28.93, 'train_speed(iter/s)': 0.398808, 'epoch': 0.88, 'global_step/max_steps': '970/1107', 'percentage': '87.62%', 'elapsed_time': '40m 30s', 'remaining_time': '5m 43s'}
{'loss': 1.31674814, 'acc': 0.69012651, 'grad_norm': 3.46496677, 'learning_rate': 3.43e-06, 'memory(GiB)': 28.93, 'train_speed(iter/s)': 0.39906, 'epoch': 0.88, 'global_step/max_steps': '980/1107', 'percentage': '88.53%', 'elapsed_time': '40m 53s', 'remaining_time': '5m 17s'}
{'loss': 1.24775572, 'acc': 0.68942866, 'grad_norm': 3.68378305, 'learning_rate': 2.91e-06, 'memory(GiB)': 28.93, 'train_speed(iter/s)': 0.399357, 'epoch': 0.89, 'global_step/max_steps': '990/1107', 'percentage': '89.43%', 'elapsed_time': '41m 16s', 'remaining_time': '4m 52s'}
{'loss': 1.29112091, 'acc': 0.6947401, 'grad_norm': 5.52747107, 'learning_rate': 2.44e-06, 'memory(GiB)': 28.93, 'train_speed(iter/s)': 0.399593, 'epoch': 0.9, 'global_step/max_steps': '1000/1107', 'percentage': '90.33%', 'elapsed_time': '41m 40s', 'remaining_time': '4m 27s'}
Val: 100%|████████████████████████████████████████████████████████████████████| 178/178 [00:07<00:00, 22.67it/s]
{'eval_loss': 1.16326594, 'eval_acc': 0.71823204, 'eval_runtime': 7.9513, 'eval_samples_per_second': 22.386, 'eval_steps_per_second': 22.386, 'epoch': 0.9, 'global_step/max_steps': '1000/1107', 'percentage': '90.33%', 'elapsed_time': '41m 48s', 'remaining_time': '4m 28s'}
[INFO:swift] Saving model checkpoint to /home/yerong2/representation-engineering/lorra_finetune/qwfine/output/qwen2_5-7b/v4-20240924-151132/checkpoint-1000
/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
Train:  99%|███████████████████████████████████████████████████████████████▌| 1100/1107 [45:48<00:16,  2.31s/it]
{'loss': 1.16514416, 'acc': 0.70591855, 'grad_norm': 4.50498056, 'learning_rate': 2.01e-06, 'memory(GiB)': 28.93, 'train_speed(iter/s)': 0.397469, 'epoch': 0.91, 'global_step/max_steps': '1010/1107', 'percentage': '91.24%', 'elapsed_time': '42m 19s', 'remaining_time': '4m 3s'}
{'loss': 1.20793447, 'acc': 0.70971303, 'grad_norm': 2.72229838, 'learning_rate': 1.62e-06, 'memory(GiB)': 28.93, 'train_speed(iter/s)': 0.397762, 'epoch': 0.92, 'global_step/max_steps': '1020/1107', 'percentage': '92.14%', 'elapsed_time': '42m 42s', 'remaining_time': '3m 38s'}
{'loss': 1.26618366, 'acc': 0.68611121, 'grad_norm': 3.58076215, 'learning_rate': 1.28e-06, 'memory(GiB)': 28.93, 'train_speed(iter/s)': 0.398093, 'epoch': 0.93, 'global_step/max_steps': '1030/1107', 'percentage': '93.04%', 'elapsed_time': '43m 5s', 'remaining_time': '3m 13s'}
{'loss': 1.17621975, 'acc': 0.70865078, 'grad_norm': 2.82895803, 'learning_rate': 9.7e-07, 'memory(GiB)': 28.93, 'train_speed(iter/s)': 0.398388, 'epoch': 0.94, 'global_step/max_steps': '1040/1107', 'percentage': '93.95%', 'elapsed_time': '43m 28s', 'remaining_time': '2m 48s'}
{'loss': 1.1816431, 'acc': 0.71681886, 'grad_norm': 2.92995811, 'learning_rate': 7e-07, 'memory(GiB)': 28.93, 'train_speed(iter/s)': 0.398599, 'epoch': 0.95, 'global_step/max_steps': '1050/1107', 'percentage': '94.85%', 'elapsed_time': '43m 52s', 'remaining_time': '2m 22s'}
{'loss': 1.23176498, 'acc': 0.69777288, 'grad_norm': 2.92958975, 'learning_rate': 4.8e-07, 'memory(GiB)': 28.93, 'train_speed(iter/s)': 0.398871, 'epoch': 0.96, 'global_step/max_steps': '1060/1107', 'percentage': '95.75%', 'elapsed_time': '44m 15s', 'remaining_time': '1m 57s'}
{'loss': 1.19563971, 'acc': 0.69778471, 'grad_norm': 3.07414246, 'learning_rate': 3e-07, 'memory(GiB)': 28.93, 'train_speed(iter/s)': 0.399093, 'epoch': 0.97, 'global_step/max_steps': '1070/1107', 'percentage': '96.66%', 'elapsed_time': '44m 39s', 'remaining_time': '1m 32s'}
{'loss': 1.14317961, 'acc': 0.73046112, 'grad_norm': 3.73116231, 'learning_rate': 1.7e-07, 'memory(GiB)': 28.93, 'train_speed(iter/s)': 0.399328, 'epoch': 0.98, 'global_step/max_steps': '1080/1107', 'percentage': '97.56%', 'elapsed_time': '45m 2s', 'remaining_time': '1m 7s'}
{'loss': 1.12737389, 'acc': 0.72538509, 'grad_norm': 3.18484712, 'learning_rate': 7e-08, 'memory(GiB)': 28.93, 'train_speed(iter/s)': 0.39959, 'epoch': 0.98, 'global_step/max_steps': '1090/1107', 'percentage': '98.46%', 'elapsed_time': '45m 25s', 'remaining_time': '42s'}
{'loss': 1.28681345, 'acc': 0.70142059, 'grad_norm': 2.19884014, 'learning_rate': 2e-08, 'memory(GiB)': 28.93, 'train_speed(iter/s)': 0.399869, 'epoch': 0.99, 'global_step/max_steps': '1100/1107', 'percentage': '99.37%', 'elapsed_time': '45m 48s', 'remaining_time': '17s'}
Val: 100%|████████████████████████████████████████████████████████████████████| 178/178 [00:07<00:00, 22.75it/s]
{'eval_loss': 1.16303635, 'eval_acc': 0.71902131, 'eval_runtime': 7.9058, 'eval_samples_per_second': 22.515, 'eval_steps_per_second': 22.515, 'epoch': 0.99, 'global_step/max_steps': '1100/1107', 'percentage': '99.37%', 'elapsed_time': '45m 56s', 'remaining_time': '17s'}
[INFO:swift] Saving model checkpoint to /home/yerong2/representation-engineering/lorra_finetune/qwfine/output/qwen2_5-7b/v4-20240924-151132/checkpoint-1100
/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
Train: 100%|████████████████████████████████████████████████████████████████| 1107/1107 [46:20<00:00,  2.82s/it]
Val: 100%|████████████████████████████████████████████████████████████████████| 178/178 [00:07<00:00, 22.81it/s]
{'eval_loss': 1.16238773, 'eval_acc': 0.71981058, 'eval_runtime': 7.9165, 'eval_samples_per_second': 22.485, 'eval_steps_per_second': 22.485, 'epoch': 1.0, 'global_step/max_steps': '1107/1107', 'percentage': '100.00%', 'elapsed_time': '46m 27s', 'remaining_time': '0s'}
[INFO:swift] Saving model checkpoint to /home/yerong2/representation-engineering/lorra_finetune/qwfine/output/qwen2_5-7b/v4-20240924-151132/checkpoint-1107
Train: 100%|████████████████████████████████████████████████████████████████| 1107/1107 [46:34<00:00,  2.52s/it]
{'train_runtime': 2795.5663, 'train_samples_per_second': 6.339, 'train_steps_per_second': 0.396, 'train_loss': 1.26825685, 'epoch': 1.0, 'global_step/max_steps': '1107/1107', 'percentage': '100.00%', 'elapsed_time': '46m 34s', 'remaining_time': '0s'}
[INFO:swift] last_model_checkpoint: /home/yerong2/representation-engineering/lorra_finetune/qwfine/output/qwen2_5-7b/v4-20240924-151132/checkpoint-1107
[INFO:swift] best_model_checkpoint: /home/yerong2/representation-engineering/lorra_finetune/qwfine/output/qwen2_5-7b/v4-20240924-151132/checkpoint-900
[INFO:swift] End time of running main: 2024-09-24 15:58:40.339317
