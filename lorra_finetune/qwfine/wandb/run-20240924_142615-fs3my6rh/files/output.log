Train:   0%|                                                                           | 0/1107 [00:00<?, ?it/s]/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
Train:   9%|█████▊                                                           | 100/1107 [02:14<22:36,  1.35s/it]
{'loss': 3.92871094, 'acc': 0.45265377, 'grad_norm': 16.33516312, 'learning_rate': 0.0, 'memory(GiB)': 16.07, 'train_speed(iter/s)': 0.236711, 'epoch': 0.0, 'global_step/max_steps': '1/1107', 'percentage': '0.09%', 'elapsed_time': '1s', 'remaining_time': '30m 40s'}
{'loss': 2.58686659, 'acc': 0.5176007, 'grad_norm': 9.75260925, 'learning_rate': 6.53e-05, 'memory(GiB)': 16.25, 'train_speed(iter/s)': 0.633532, 'epoch': 0.01, 'global_step/max_steps': '10/1107', 'percentage': '0.90%', 'elapsed_time': '13s', 'remaining_time': '24m 10s'}
{'loss': 0.95659332, 'acc': 0.76118326, 'grad_norm': 3.79299951, 'learning_rate': 8.495e-05, 'memory(GiB)': 16.43, 'train_speed(iter/s)': 0.699559, 'epoch': 0.02, 'global_step/max_steps': '20/1107', 'percentage': '1.81%', 'elapsed_time': '26s', 'remaining_time': '23m 34s'}
{'loss': 0.78777161, 'acc': 0.78156042, 'grad_norm': 3.10380268, 'learning_rate': 9.645e-05, 'memory(GiB)': 16.88, 'train_speed(iter/s)': 0.706616, 'epoch': 0.03, 'global_step/max_steps': '30/1107', 'percentage': '2.71%', 'elapsed_time': '39s', 'remaining_time': '23m 52s'}
{'loss': 0.87397308, 'acc': 0.76471343, 'grad_norm': 4.20274115, 'learning_rate': 9.999e-05, 'memory(GiB)': 16.88, 'train_speed(iter/s)': 0.713664, 'epoch': 0.04, 'global_step/max_steps': '40/1107', 'percentage': '3.61%', 'elapsed_time': '53s', 'remaining_time': '23m 46s'}
{'loss': 0.85631714, 'acc': 0.77321396, 'grad_norm': 3.23394322, 'learning_rate': 9.995e-05, 'memory(GiB)': 16.88, 'train_speed(iter/s)': 0.723553, 'epoch': 0.05, 'global_step/max_steps': '50/1107', 'percentage': '4.52%', 'elapsed_time': '1m 6s', 'remaining_time': '23m 26s'}
{'loss': 0.82708435, 'acc': 0.78923535, 'grad_norm': 3.25169349, 'learning_rate': 9.986e-05, 'memory(GiB)': 17.34, 'train_speed(iter/s)': 0.726334, 'epoch': 0.05, 'global_step/max_steps': '60/1107', 'percentage': '5.42%', 'elapsed_time': '1m 20s', 'remaining_time': '23m 16s'}
{'loss': 0.67521667, 'acc': 0.81338863, 'grad_norm': 3.15534186, 'learning_rate': 9.972e-05, 'memory(GiB)': 17.34, 'train_speed(iter/s)': 0.725723, 'epoch': 0.06, 'global_step/max_steps': '70/1107', 'percentage': '6.32%', 'elapsed_time': '1m 33s', 'remaining_time': '23m 10s'}
{'loss': 0.85751801, 'acc': 0.76359868, 'grad_norm': 2.49790215, 'learning_rate': 9.955e-05, 'memory(GiB)': 17.34, 'train_speed(iter/s)': 0.726882, 'epoch': 0.07, 'global_step/max_steps': '80/1107', 'percentage': '7.23%', 'elapsed_time': '1m 47s', 'remaining_time': '23m 0s'}
{'loss': 0.84459381, 'acc': 0.78083091, 'grad_norm': 2.8861258, 'learning_rate': 9.933e-05, 'memory(GiB)': 17.34, 'train_speed(iter/s)': 0.728521, 'epoch': 0.08, 'global_step/max_steps': '90/1107', 'percentage': '8.13%', 'elapsed_time': '2m 0s', 'remaining_time': '22m 47s'}
{'loss': 0.81604614, 'acc': 0.78945365, 'grad_norm': 2.49534011, 'learning_rate': 9.907e-05, 'memory(GiB)': 17.34, 'train_speed(iter/s)': 0.730162, 'epoch': 0.09, 'global_step/max_steps': '100/1107', 'percentage': '9.03%', 'elapsed_time': '2m 14s', 'remaining_time': '22m 33s'}
Val: 100%|██████████████████████████████████████████████████████████████████████| 89/89 [00:03<00:00, 22.74it/s]
{'eval_loss': 0.79670221, 'eval_acc': 0.79321231, 'eval_runtime': 4.0188, 'eval_samples_per_second': 44.292, 'eval_steps_per_second': 22.146, 'epoch': 0.09, 'global_step/max_steps': '100/1107', 'percentage': '9.03%', 'elapsed_time': '2m 18s', 'remaining_time': '23m 13s'}
[INFO:swift] Saving model checkpoint to /home/yerong2/representation-engineering/lorra_finetune/qwfine/output/qwen-7b/v3-20240924-142532/checkpoint-100
/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
Train:  11%|███████▎                                                         | 125/1107 [02:59<22:29,  1.37s/it]Traceback (most recent call last):
{'loss': 0.76279373, 'acc': 0.80877304, 'grad_norm': 2.8926003, 'learning_rate': 9.877e-05, 'memory(GiB)': 17.34, 'train_speed(iter/s)': 0.678112, 'epoch': 0.1, 'global_step/max_steps': '110/1107', 'percentage': '9.94%', 'elapsed_time': '2m 39s', 'remaining_time': '24m 7s'}
{'loss': 0.75668945, 'acc': 0.7959218, 'grad_norm': 3.55644894, 'learning_rate': 9.842e-05, 'memory(GiB)': 16.97, 'train_speed(iter/s)': 0.683524, 'epoch': 0.11, 'global_step/max_steps': '120/1107', 'percentage': '10.84%', 'elapsed_time': '2m 52s', 'remaining_time': '23m 42s'}
  File "/home/yerong2/representation-engineering/lorra_finetune/qwfine/llm_sft.py", line 7, in <module>
    output = sft_main()
             ^^^^^^^^^^
  File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/swift/utils/run_utils.py", line 32, in x_main
    result = llm_x(args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/swift/llm/sft.py", line 517, in llm_sft
    return trainer_train(args, model, template, train_dataset, val_dataset, callbacks=callbacks, msg=msg)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/swift/llm/sft.py", line 467, in trainer_train
    trainer.train(training_args.resume_from_checkpoint)
  File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/swift/trainers/mixin.py", line 424, in train
    res = super().train(resume_from_checkpoint, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/transformers/trainer.py", line 1938, in train
    return inner_training_loop(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/transformers/trainer.py", line 2279, in _inner_training_loop
    tr_loss_step = self.training_step(model, inputs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/transformers/trainer.py", line 3318, in training_step
    loss = self.compute_loss(model, inputs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/swift/trainers/trainers.py", line 161, in compute_loss
    outputs = model(**inputs)
              ^^^^^^^^^^^^^^^
  File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/deepspeed/utils/nvtx.py", line 18, in wrapped_fn
    ret_val = func(*args, **kwargs)
              ^^^^^^^^^^^^^^^^^^^^^
  File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/deepspeed/runtime/engine.py", line 1899, in forward
    loss = self.module(*inputs, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1603, in _call_impl
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/peft/peft_model.py", line 1577, in forward
    return self.base_model(
           ^^^^^^^^^^^^^^^^
  File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/peft/tuners/tuners_utils.py", line 188, in forward
    return self.model.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yerong2/.cache/huggingface/modules/transformers_modules/Qwen-7B/modeling_qwen.py", line 1043, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yerong2/.cache/huggingface/modules/transformers_modules/Qwen-7B/modeling_qwen.py", line 880, in forward
    outputs = torch.utils.checkpoint.checkpoint(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/swift/llm/utils/model.py", line 6532, in <lambda>
    lambda *args, use_reentrant=_use_reentrant, **kwargs: _old_checkpoint(
                                                          ^^^^^^^^^^^^^^^^
  File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/torch/_compile.py", line 31, in inner
    return disable_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 600, in _fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/torch/utils/checkpoint.py", line 488, in checkpoint
    ret = function(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yerong2/.cache/huggingface/modules/transformers_modules/Qwen-7B/modeling_qwen.py", line 876, in custom_forward
    return module(*inputs, use_cache, output_attentions)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yerong2/.cache/huggingface/modules/transformers_modules/Qwen-7B/modeling_qwen.py", line 610, in forward
    attn_outputs = self.attn(
                   ^^^^^^^^^^
  File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yerong2/.cache/huggingface/modules/transformers_modules/Qwen-7B/modeling_qwen.py", line 528, in forward
    attn_output = F.scaled_dot_product_attention(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/torch/utils/checkpoint.py", line 1092, in pack_hook
    def pack_hook(x):

KeyboardInterrupt
[rank0]: Traceback (most recent call last):
[rank0]:   File "/home/yerong2/representation-engineering/lorra_finetune/qwfine/llm_sft.py", line 7, in <module>
[rank0]:     output = sft_main()
[rank0]:              ^^^^^^^^^^
[rank0]:   File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/swift/utils/run_utils.py", line 32, in x_main
[rank0]:     result = llm_x(args, **kwargs)
[rank0]:              ^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/swift/llm/sft.py", line 517, in llm_sft
[rank0]:     return trainer_train(args, model, template, train_dataset, val_dataset, callbacks=callbacks, msg=msg)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/swift/llm/sft.py", line 467, in trainer_train
[rank0]:     trainer.train(training_args.resume_from_checkpoint)
[rank0]:   File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/swift/trainers/mixin.py", line 424, in train
[rank0]:     res = super().train(resume_from_checkpoint, *args, **kwargs)
[rank0]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/transformers/trainer.py", line 1938, in train
[rank0]:     return inner_training_loop(
[rank0]:            ^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/transformers/trainer.py", line 2279, in _inner_training_loop
[rank0]:     tr_loss_step = self.training_step(model, inputs)
[rank0]:                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/transformers/trainer.py", line 3318, in training_step
[rank0]:     loss = self.compute_loss(model, inputs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/swift/trainers/trainers.py", line 161, in compute_loss
[rank0]:     outputs = model(**inputs)
[rank0]:               ^^^^^^^^^^^^^^^
[rank0]:   File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/deepspeed/utils/nvtx.py", line 18, in wrapped_fn
[rank0]:     ret_val = func(*args, **kwargs)
[rank0]:               ^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/deepspeed/runtime/engine.py", line 1899, in forward
[rank0]:     loss = self.module(*inputs, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1603, in _call_impl
[rank0]:     result = forward_call(*args, **kwargs)
[rank0]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/peft/peft_model.py", line 1577, in forward
[rank0]:     return self.base_model(
[rank0]:            ^^^^^^^^^^^^^^^^
[rank0]:   File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/peft/tuners/tuners_utils.py", line 188, in forward
[rank0]:     return self.model.forward(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/yerong2/.cache/huggingface/modules/transformers_modules/Qwen-7B/modeling_qwen.py", line 1043, in forward
[rank0]:     transformer_outputs = self.transformer(
[rank0]:                           ^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/yerong2/.cache/huggingface/modules/transformers_modules/Qwen-7B/modeling_qwen.py", line 880, in forward
[rank0]:     outputs = torch.utils.checkpoint.checkpoint(
[rank0]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/swift/llm/utils/model.py", line 6532, in <lambda>
[rank0]:     lambda *args, use_reentrant=_use_reentrant, **kwargs: _old_checkpoint(
[rank0]:                                                           ^^^^^^^^^^^^^^^^
[rank0]:   File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/torch/_compile.py", line 31, in inner
[rank0]:     return disable_fn(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 600, in _fn
[rank0]:     return fn(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/torch/utils/checkpoint.py", line 488, in checkpoint
[rank0]:     ret = function(*args, **kwargs)
[rank0]:           ^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/yerong2/.cache/huggingface/modules/transformers_modules/Qwen-7B/modeling_qwen.py", line 876, in custom_forward
[rank0]:     return module(*inputs, use_cache, output_attentions)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/yerong2/.cache/huggingface/modules/transformers_modules/Qwen-7B/modeling_qwen.py", line 610, in forward
[rank0]:     attn_outputs = self.attn(
[rank0]:                    ^^^^^^^^^^
[rank0]:   File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/yerong2/.cache/huggingface/modules/transformers_modules/Qwen-7B/modeling_qwen.py", line 528, in forward
[rank0]:     attn_output = F.scaled_dot_product_attention(
[rank0]:                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/torch/utils/checkpoint.py", line 1092, in pack_hook
[rank0]:     def pack_hook(x):

[rank0]: KeyboardInterrupt
