Train:   0%|                                                                           | 0/100 [00:00<?, ?it/s]/home/yerong2/local/miniconda3/envs/qw/lib/python3.11/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]
Train: 100%|█████████████████████████████████████████████████████████████████| 100/100 [03:52<00:00,  2.34s/it]
{'loss': 2.69973183, 'acc': 0.47710815, 'grad_norm': 3.78417444, 'learning_rate': 0.0, 'memory(GiB)': 19.7, 'train_speed(iter/s)': 0.209911, 'epoch': 0.0, 'global_step/max_steps': '1/100', 'percentage': '1.00%', 'elapsed_time': '2s', 'remaining_time': '4m 33s'}
{'loss': 3.06259685, 'acc': 0.41984865, 'grad_norm': 6.96831942, 'learning_rate': 9.872e-05, 'memory(GiB)': 19.7, 'train_speed(iter/s)': 0.401004, 'epoch': 0.01, 'global_step/max_steps': '10/100', 'percentage': '10.00%', 'elapsed_time': '22s', 'remaining_time': '3m 26s'}
{'loss': 1.76234913, 'acc': 0.62273812, 'grad_norm': 2.4991858, 'learning_rate': 9.261e-05, 'memory(GiB)': 23.63, 'train_speed(iter/s)': 0.414543, 'epoch': 0.02, 'global_step/max_steps': '20/100', 'percentage': '20.00%', 'elapsed_time': '46s', 'remaining_time': '3m 4s'}
{'loss': 1.25101004, 'acc': 0.69062867, 'grad_norm': 4.13194084, 'learning_rate': 8.207e-05, 'memory(GiB)': 23.63, 'train_speed(iter/s)': 0.418241, 'epoch': 0.03, 'global_step/max_steps': '30/100', 'percentage': '30.00%', 'elapsed_time': '1m 9s', 'remaining_time': '2m 42s'}
{'loss': 1.43132505, 'acc': 0.67912436, 'grad_norm': 2.60249043, 'learning_rate': 6.82e-05, 'memory(GiB)': 23.63, 'train_speed(iter/s)': 0.42081, 'epoch': 0.04, 'global_step/max_steps': '40/100', 'percentage': '40.00%', 'elapsed_time': '1m 33s', 'remaining_time': '2m 19s'}
{'loss': 1.32357111, 'acc': 0.679283, 'grad_norm': 2.95817351, 'learning_rate': 5.243e-05, 'memory(GiB)': 23.63, 'train_speed(iter/s)': 0.422682, 'epoch': 0.05, 'global_step/max_steps': '50/100', 'percentage': '50.00%', 'elapsed_time': '1m 56s', 'remaining_time': '1m 56s'}
{'loss': 1.39365215, 'acc': 0.67674694, 'grad_norm': 2.92336869, 'learning_rate': 3.641e-05, 'memory(GiB)': 23.63, 'train_speed(iter/s)': 0.423922, 'epoch': 0.05, 'global_step/max_steps': '60/100', 'percentage': '60.00%', 'elapsed_time': '2m 19s', 'remaining_time': '1m 33s'}
{'loss': 1.39930925, 'acc': 0.69126163, 'grad_norm': 3.7958796, 'learning_rate': 2.181e-05, 'memory(GiB)': 23.63, 'train_speed(iter/s)': 0.424359, 'epoch': 0.06, 'global_step/max_steps': '70/100', 'percentage': '70.00%', 'elapsed_time': '2m 42s', 'remaining_time': '1m 9s'}
{'loss': 1.29701185, 'acc': 0.68727303, 'grad_norm': 3.67412519, 'learning_rate': 1.014e-05, 'memory(GiB)': 23.63, 'train_speed(iter/s)': 0.425495, 'epoch': 0.07, 'global_step/max_steps': '80/100', 'percentage': '80.00%', 'elapsed_time': '3m 6s', 'remaining_time': '46s'}
{'loss': 1.36755791, 'acc': 0.68004413, 'grad_norm': 3.54291415, 'learning_rate': 2.61e-06, 'memory(GiB)': 23.63, 'train_speed(iter/s)': 0.426014, 'epoch': 0.08, 'global_step/max_steps': '90/100', 'percentage': '90.00%', 'elapsed_time': '3m 29s', 'remaining_time': '23s'}
{'loss': 1.33611755, 'acc': 0.69712706, 'grad_norm': 2.16452527, 'learning_rate': 1e-08, 'memory(GiB)': 23.63, 'train_speed(iter/s)': 0.425864, 'epoch': 0.09, 'global_step/max_steps': '100/100', 'percentage': '100.00%', 'elapsed_time': '3m 52s', 'remaining_time': '0s'}
Val: 100%|███████████████████████████████████████████████████████████████████| 178/178 [00:07<00:00, 22.82it/s]
{'eval_loss': 1.32454431, 'eval_acc': 0.70086819, 'eval_runtime': 7.8805, 'eval_samples_per_second': 22.587, 'eval_steps_per_second': 22.587, 'epoch': 0.09, 'global_step/max_steps': '100/100', 'percentage': '100.00%', 'elapsed_time': '4m 0s', 'remaining_time': '0s'}
[INFO:swift] Saving model checkpoint to /home/yerong2/representation-engineering/lorra_finetune/qwfine/output/qwen2_5-7b/v17-20240926-073918/checkpoint-100
Train: 100%|█████████████████████████████████████████████████████████████████| 100/100 [04:07<00:00,  2.48s/it]
{'train_runtime': 248.4374, 'train_samples_per_second': 6.44, 'train_steps_per_second': 0.403, 'train_loss': 1.55882144, 'epoch': 0.09, 'global_step/max_steps': '100/100', 'percentage': '100.00%', 'elapsed_time': '4m 7s', 'remaining_time': '0s'}
[INFO:swift] last_model_checkpoint: /home/yerong2/representation-engineering/lorra_finetune/qwfine/output/qwen2_5-7b/v17-20240926-073918/checkpoint-100
[INFO:swift] best_model_checkpoint: /home/yerong2/representation-engineering/lorra_finetune/qwfine/output/qwen2_5-7b/v17-20240926-073918/checkpoint-100
[INFO:swift] End time of running main: 2024-09-26 07:43:59.530422
